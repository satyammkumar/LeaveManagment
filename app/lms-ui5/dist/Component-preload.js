//@ui5-bundle lmsui5/Component-preload.js
sap.ui.predefine("lmsui5/Component", ["sap/ui/core/UIComponent","lmsui5/model/models"],(e,t)=>{"use strict";return e.extend("lmsui5.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init(){e.prototype.init.apply(this,arguments);this.setModel(t.createDeviceModel(),"device");this.getRouter().initialize()}})});
sap.ui.predefine("lmsui5/controller/App.controller", ["sap/ui/core/mvc/Controller"],e=>{"use strict";return e.extend("lmsui5.controller.App",{onInit(){}})});
sap.ui.predefine("lmsui5/controller/ApplyLeave.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/format/DateFormat"],function(e,t,a,n,o){"use strict";return e.extend("lmsui5.controller.ApplyLeave",{onInit:function(){var e=new t({selectedLeaveType:"",selectedDates:[],reason:"",minDate:null,maxDate:null});this.getView().setModel(e,"applyLeave");this._oDateFmt=o.getDateInstance({pattern:"yyyy-MM-dd"})},onCalendarSelect:function(){var e=this.byId("leaveCalendar");var t=e.getSelectedDates()||[];var a=[];t.forEach(function(e){var t=e.getStartDate();var n=e.getEndDate();if(t&&n){var o=new Date(t);o.setHours(0,0,0,0);var s=new Date(n);s.setHours(0,0,0,0);while(o<=s){a.push(new Date(o.getFullYear(),o.getMonth(),o.getDate()));o.setDate(o.getDate()+1)}}else if(t){var r=new Date(t.getFullYear(),t.getMonth(),t.getDate());a.push(r)}});var n={};a=a.filter(function(e){var t=e.toDateString();if(n[t])return false;n[t]=true;return true}).sort(function(e,t){return e-t});this.getView().getModel("applyLeave").setProperty("/selectedDates",a)},_toYMD:function(e){var t=e.getFullYear();var a=String(e.getMonth()+1).padStart(2,"0");var n=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${n}`},_fetchLeaveTypeByCode:async function(e){const t=this.getView().getModel();const a=t.bindList("/LeaveTypes",null,null,null,{$select:"ID,code",$filter:"code eq '"+String(e).replace(/'/g,"''")+"'"});const n=await a.requestContexts(0,1);if(!n.length){throw new Error("Leave type not found for code: "+e)}const o=n[0].getObject();return{id:o.ID,code:o.code}},onSubmitLeave:async function(){const e=this.getView();const t=e.getModel("applyLeave");const o=e.getModel();const s=this.getOwnerComponent().getModel("auth");const r=t.getProperty("/selectedLeaveType");const l=t.getProperty("/selectedDates")||[];const i=t.getProperty("/reason")||"";const c=s&&s.getProperty("/user")||{};const u=c.id;const g=c.employeeID;if(!r){n.warning("Please select a leave type.");return}if(!l.length){n.warning("Please select at least one date.");return}if(!u||!g){n.error("Missing employee identity. Please log in again.");return}const d=l.slice().sort((e,t)=>e-t);const p=this._toYMD(d[0]);const y=this._toYMD(d[d.length-1]);try{const e=await this._fetchLeaveTypeByCode(r);const t={employee_ID:u,employee_employeeId:g,leaveType_ID:e.id,leaveType_code:e.code,startDate:p,endDate:y,reason:i,status:"Pending"};const n=o.bindList("/LeaveRequests");const s=n.create(t);await s.created();const l=s.getObject();const c=l&&(l.ID||l.ID_cuid||l.ID_uuid);a.show("Leave submitted successfully.");this.getOwnerComponent().getRouter().navTo("ManagerNoId")}catch(e){var v="Failed to submit leave request.";if(e&&e.message)v+="\n"+e.message;n.error(v)}},onCancelApplyLeave:function(){this.byId("applyLeaveDialog").close()}})});
sap.ui.predefine("lmsui5/controller/Employee.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/Fragment","sap/ui/core/format/DateFormat"],function(e,t,s,n,a,o,r,i){"use strict";return e.extend("lmsui5.controller.Employee",{onInit:function(){if(!this.getOwnerComponent().getModel("user")){this.getOwnerComponent().setModel(new n({}),"user")}this.getView().setModel(new n(this._buildApplyLeaveModelData()),"applyLeave");this.getView().setModel(new n({requests:[],counts:{total:0,pending:0,approved:0,rejected:0}}),"leaveRequests");const e=this.getOwnerComponent().getRouter();e.getRoute("Employee").attachPatternMatched(this._onRouteMatched,this);this.getView().addEventDelegate({onAfterShow:function(){this._applyEmployeeFilter();this._refreshOwnLeaveData()}.bind(this)});this._bus=sap.ui.getCore().getEventBus();this._bus.subscribe("leave","changed",this._onLeaveChanged,this)},onExit:function(){if(this._pApplyLeaveDlg){this._pApplyLeaveDlg.then(function(e){e.destroy()});this._pApplyLeaveDlg=null}if(this._pRequestDetailsDlg){this._pRequestDetailsDlg.then(function(e){e.destroy()});this._pRequestDetailsDlg=null}if(this._pManagerMsgDlg){this._pManagerMsgDlg.then(function(e){e.destroy()});this._pManagerMsgDlg=null}if(this._bus){this._bus.unsubscribe("leave","changed",this._onLeaveChanged,this)}},getEmployeeData:async function(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!t.test(e)){this._showError("Please enter a valid email address.");return}const s=this.byId("msg");if(s)s.setVisible(false);try{const t=await fetch("/odata/v4/my-services/getEmployeeData",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!t.ok){const e=t.clone();let s="Failed to fetch employee data";try{s=(await t.json())?.error?.message||s}catch{try{s=await e.text()}catch{}}throw new Error(s)}const s=await t.json();const n=this.getOwnerComponent().getModel("user");if(n&&s.employee){n.setProperty("/id",s.employee.id);n.setProperty("/employeeId",s.employee.employeeID);n.setProperty("/firstName",s.employee.firstName);n.setProperty("/lastName",s.employee.lastName);n.setProperty("/email",s.employee.email);n.setProperty("/department",s.employee.department);n.setProperty("/managerId",s.employee.managerID);const e=`${s.employee.firstName||""} ${s.employee.lastName||""}`.trim();n.setProperty("/fullName",e);if(Array.isArray(s.leaveBalances)){n.setProperty("/leaveBalances",s.leaveBalances)}}a.show("Employee data loaded successfully");this._applyEmployeeFilter();this._loadMyLeaveRequests()}catch(e){this._showError(e.message||"Failed to load employee data");console.error("API Error:",e)}},_showError:function(e){a.show(e,{duration:3e3})},_onRouteMatched:function(e){const t=e.getParameter("arguments");const s=t.username;const n=this.getOwnerComponent().getModel("auth");if(n&&s){n.setProperty("/username",s)}if(s){this.getEmployeeData(s)}},_applyEmployeeFilter:function(){const e=this.getOwnerComponent().getModel("user");const n=e&&e.getProperty("/employeeId");const a=this.byId("balancesTable")?.getBinding("items");if(!a)return;if(n){a.filter([new t("employee/employeeId",s.EQ,n)])}else{a.filter([])}},onSearch:function(e){const t=e.getParameter("query");this._applySearchFilter(t)},onLiveChange:function(e){const t=e.getParameter("newValue");this._applySearchFilter(t)},_applySearchFilter:function(e){const n=this.byId("balancesTable")?.getBinding("items");if(!n)return;const a=[];const o=this.getOwnerComponent().getModel("user");const r=o&&o.getProperty("/employeeId");if(r){a.push(new t("employee/employeeId",s.EQ,r))}if(e){a.push(new t({filters:[new t("leaveType/code",s.Contains,e),new t("leaveType/description",s.Contains,e)],and:false}))}n.filter(a)},onClear:function(){const e=this.byId("sf");e&&e.setValue("");this._applySearchFilter("")},onRefresh:function(){const e=this.byId("balancesTable")?.getBinding("items");if(e){e.refresh();a.show("Data refreshed")}this._loadMyLeaveRequests()},onLogout:function(){var e=this;sap.m.MessageBox.confirm("Are you sure you want to logout?",{actions:[sap.m.MessageBox.Action.OK,sap.m.MessageBox.Action.CANCEL],emphasizedAction:sap.m.MessageBox.Action.OK,onClose:function(t){if(t!==sap.m.MessageBox.Action.OK){return}try{sessionStorage.clear()}catch(e){}try{localStorage.clear()}catch(e){}if(sap.ushell&&sap.ushell.Container){try{window.location.hash="#Shell-home";return}catch(e){}}var s=e.getOwnerComponent&&e.getOwnerComponent();var n=s&&s.getRouter&&s.getRouter();if(n&&n.navTo){n.navTo("Login",{},true);return}window.location.replace("/login")}})},formatBalanceState:function(e){const t=Number(e);if(isNaN(t))return"None";if(t<0)return"Error";if(t===0)return"Warning";return"Success"},formatStatusState:function(e){switch((e||"").toLowerCase()){case"pending":return"Warning";case"approved":return"Success";case"rejected":return"Error";case"cancelled":return"None";default:return"None"}},formatDateRange:function(e,t){if(!e&&!t)return"";try{const s=i.getDateInstance({style:"medium"});const n=e?s.format(new Date(e)):"";const a=t?s.format(new Date(t)):"";return n&&a?`${n} ‚Üí ${a}`:n||a}catch(s){return`${e||""} ‚Üí ${t||""}`}},formatDateTime:function(e){if(!e)return"";try{const t=i.getDateTimeInstance({style:"medium"});return t.format(new Date(e))}catch(t){return e}},_loadMyLeaveRequests:async function(){const e=this.getOwnerComponent().getModel("user");const t=e?.getProperty("/employeeId");if(!t)return;try{const e=await fetch("/odata/v4/my-services/leaveRequests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({employeeID:t})});if(!e.ok)throw new Error("Failed to load leave requests");const s=await e.json();const n=s.requests||[];const a={total:n.length,pending:n.filter(e=>e.status==="Pending").length,approved:n.filter(e=>e.status==="Approved").length,rejected:n.filter(e=>e.status==="Rejected").length};const o=this.getView().getModel("leaveRequests");o.setProperty("/requests",n);o.setProperty("/counts",a);this._checkForRejectionNotifications(n)}catch(e){console.error("Failed to load leave requests:",e)}},_checkForRejectionNotifications:function(e){const t=e.filter(e=>e.status==="Rejected"&&e.managerComments);if(t.length>0){const e=t[0];o.warning(e.managerComments||"No reason provided by manager",{title:"Leave Request Rejected",details:`Leave Type: ${e.leaveType}\nPeriod: ${this.formatDateRange(e.startDate,e.endDate)}\nDays: ${e.daysRequested}`,actions:[o.Action.OK,"View All Requests"],emphasizedAction:o.Action.OK,onClose:e=>{if(e==="View All Requests"){const e=this.byId("myRequestsTable");if(e){e.getDomRef()?.scrollIntoView({behavior:"smooth"})}}}})}},onViewRequestDetails:function(e){const t=e.getSource().getBindingContext("leaveRequests");const s=t&&t.getObject();if(!s)return;const n=this.getView().getId()+"--requestDetailsFrag";if(!this._pRequestDetailsDlg){this._pRequestDetailsDlg=r.load({name:"lmsui5.view.RequestDetail",controller:this,id:n}).then(function(e){this.getView().addDependent(e);return e}.bind(this)).catch(function(e){console.error("RequestDetail fragment load failed:",e);o.error(e.message||"Failed to open the details dialog.")})}this._pRequestDetailsDlg.then(function(e){e.setBindingContext(t,"leaveRequests");e.open()})},onCloseRequestDetails:function(){if(this._pRequestDetailsDlg){this._pRequestDetailsDlg.then(function(e){e.close()})}},onOpenApplyLeave:function(){const e=this.getView().getModel("applyLeave");e.setData(this._buildApplyLeaveModelData());const t=this.getView().getId()+"--applyLeaveFrag";if(!this._pApplyLeaveDlg){this._pApplyLeaveDlg=r.load({name:"lmsui5.view.ApplyLeave",controller:this,id:t}).then(function(e){this.getView().addDependent(e);return e}.bind(this)).catch(function(e){console.error("ApplyLeave fragment load failed:",e);o.error("Failed to load Apply Leave dialog.")})}this._pApplyLeaveDlg.then(function(e){const s=r.byId(t,"leaveCalendar");if(s){if(s.setSingleSelection)s.setSingleSelection(true);if(s.setIntervalSelection)s.setIntervalSelection(true);s.removeAllSelectedDates()}e.open()})},onCancelApplyLeave:function(){const e=this.getView().getId()+"--applyLeaveFrag";if(this._pApplyLeaveDlg){this._pApplyLeaveDlg.then(function(t){const s=r.byId(e,"leaveCalendar");if(s)s.removeAllSelectedDates();t.close()})}this.getView().getModel("applyLeave").setData(this._buildApplyLeaveModelData())},onCalendarSelect:function(e){const t=e.getSource();const s=t.getSelectedDates()||[];const n=s[0];const a=this.getView().getModel("applyLeave");if(n){const e=n.getStartDate();const t=n.getEndDate()||e;const s=this._toISODate(e);const o=this._toISODate(t);const r=this._expandBusinessDates(e,t);const i=r.length;a.setProperty("/startDate",e);a.setProperty("/endDate",t);a.setProperty("/startDateISO",s);a.setProperty("/endDateISO",o);a.setProperty("/totalDays",i);a.setProperty("/selectedDates",r);a.setProperty("/rangeText",i?`Selected: ${s} ‚Üí ${o} (${i} business day${i>1?"s":""})`:`Selected: ${s} ‚Üí ${o} (0 business days ‚Äî weekends excluded)`)}else{a.setProperty("/startDate",null);a.setProperty("/endDate",null);a.setProperty("/startDateISO","");a.setProperty("/endDateISO","");a.setProperty("/totalDays",0);a.setProperty("/selectedDates",[]);a.setProperty("/rangeText","")}},onSubmitLeave:async function(){const e=this.getView().getModel("applyLeave");const t=this.getOwnerComponent().getModel("user")?.getProperty("/employeeId");const s=e.getProperty("/selectedLeaveType");const n=e.getProperty("/startDateISO");const r=e.getProperty("/endDateISO");const i=(e.getProperty("/reason")||"").trim();if(!s){return o.warning("Please select a leave type.")}if(!n||!r){return o.warning("Please select a valid date range.")}try{const e=this.getView().getModel();const o=e.bindContext("/submitLeaveRequest(...)");o.setParameter("employeeId",t);o.setParameter("leaveTypeCode",s);o.setParameter("startDate",n);o.setParameter("endDate",r);o.setParameter("reason",i);await o.execute();a.show("Leave application submitted.");this.onCancelApplyLeave();await this._refreshOwnLeaveData();sap.ui.getCore().getEventBus().publish("leave","changed",{employeeId:t,source:"employee",change:"submitted"})}catch(e){console.error("Submit leave error:",e);o.error(e.message||"Failed to submit leave request")}},_buildApplyLeaveModelData:function(){return{selectedLeaveType:"",leaveTypes:this._getAvailableLeaveTypes(),minDate:this._getTodayStart(),maxDate:this._getYearEnd(),startDate:null,endDate:null,startDateISO:"",endDateISO:"",totalDays:0,selectedDates:[],rangeText:"",reason:""}},_getAvailableLeaveTypes:function(){const e=this.getOwnerComponent().getModel("user");const t=new Map;const s=e?.getProperty("/leaveTypes");if(Array.isArray(s)&&s.length){s.forEach(function(e){const s=e.code||e.leaveTypeCode||"";const n=e.description||e.code||"";if(s&&!t.has(s))t.set(s,{code:s,description:n})})}const n=e?.getProperty("/leaveBalances")||[];n.forEach(function(e){const s=e.leaveTypeCode;const n=e.leaveTypeDescription||e.description||s;if(s&&!t.has(s))t.set(s,{code:s,description:n})});if(t.size===0){return[{code:"CL",description:"Casual Leave"},{code:"SL",description:"Sick Leave"},{code:"EL",description:"Earned Leave"}]}return Array.from(t.values())},_getTodayStart:function(){const e=new Date;e.setHours(0,0,0,0);return e},_getYearEnd:function(){const e=new Date;e.setMonth(11,31);e.setHours(23,59,59,999);return e},_toISODate:function(e){const t=e.getFullYear();const s=String(e.getMonth()+1).padStart(2,"0");const n=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${n}`},_isWeekend:function(e){const t=e.getDay();return t===0||t===6},_expandBusinessDates:function(e,t){const s=[];const n=new Date(e.getFullYear(),e.getMonth(),e.getDate());const a=new Date(t.getFullYear(),t.getMonth(),t.getDate());while(n<=a){if(!this._isWeekend(n)){s.push(this._toISODate(n))}n.setDate(n.getDate()+1)}return s},_refreshOwnLeaveData:async function(){const e=this.byId("balancesTable")?.getBinding("items");e?.refresh();await this._loadMyLeaveRequests();try{const e=this.getOwnerComponent().getModel("auth")?.getProperty("/username");if(e){const t=await fetch("/odata/v4/my-services/getEmployeeData",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(t.ok){const e=await t.json();const s=this.getOwnerComponent().getModel("user");if(s&&e.employee){s.setProperty("/leaveBalances",e.leaveBalances||[])}}}}catch(e){}},_onLeaveChanged:function(e,t,s){try{const e=this.getOwnerComponent().getModel("user")?.getProperty("/employeeId");if(!e)return;if(s&&s.employeeId&&s.employeeId!==e)return;this._refreshOwnLeaveData()}catch(e){}},__mmFallback:function(e){if(e&&String(e).trim())return e;return"No message from manager yet."},onOpenManagerMessage:function(e){const t=e.getSource().getBindingContext("leaveRequests")||e.getSource().getBindingContext();if(!t){return sap.m.MessageToast.show("No request selected.")}const s=this.getView().getId()+"--managerMessageFrag";if(!this._pManagerMsgDlg){this._pManagerMsgDlg=r.load({name:"lmsui5.view.ManagerMessageDialog",controller:this,id:s}).then(function(e){this.getView().addDependent(e);return e}.bind(this)).catch(function(e){console.error("ManagerMessageDialog load failed:",e);o.error(e.message||"Failed to open the message dialog.")})}this._pManagerMsgDlg.then(function(e){e.setBindingContext(t,"leaveRequests");e.open()})},onCloseManagerMessage:function(){if(this._pManagerMsgDlg){this._pManagerMsgDlg.then(function(e){e.close()})}},onManagerMessageLiveChange:function(){},onCopyManagerMessage:function(){const e=this.getView().getId()+"--managerMessageFrag";const t=r.byId(e,"mmText");const s=t?.getValue()||"";if(!navigator.clipboard){try{const e=document.createElement("textarea");e.value=s;e.style.position="fixed";e.style.left="-9999px";document.body.appendChild(e);e.select();document.execCommand("copy");document.body.removeChild(e);a.show("Message copied")}catch(e){o.information("Copy not available on this browser.")}return}navigator.clipboard.writeText(s).then(()=>a.show("Message copied"),()=>o.information("Copy not available on this browser."))}})});
sap.ui.predefine("lmsui5/controller/Manager.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox","sap/ui/core/format/DateFormat","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,o,s,n,r,i){"use strict";return e.extend("lmsui5.controller.Manager",{onInit:function(){const e=new t({kpi:{pending:0,approvedToday:0,rejectedToday:0},counts:{leaveRequests:""},leaveTypes:[],leaveTypeDescByCode:{},leaveTypeFullDescByCode:{},rejectData:{employeeName:"",leaveType:"",comments:"",commentLength:0,requestId:"",isBulk:false,bulkRequests:[]},busy:true,dataLoaded:false,useActionFeed:false,lastActionEmployeeID:""});this.getView().setModel(e,"view");this.byId("selStatus")?.setSelectedKey("Pending");const o=this.getView().getModel();if(o&&o.setSizeLimit){o.setSizeLimit(1e4)}this._loadLeaveTypes()},_loadLeaveTypes:function(){const e=this.getView().getModel();const t=this.getView().getModel("view");if(!e||!e.read){console.error("OData model not available");t.setProperty("/busy",false);return}e.read("/LeaveTypes",{urlParameters:{$select:"code,description"},success:e=>{const o=e?.results||e?.value||[];const s={};const n={};o.forEach(e=>{const t=String(e.code).trim().toUpperCase();const o=e.description||"";s[t]=o||t;n[t]=o?`${t} - ${o}`:t});t.setProperty("/leaveTypes",o);t.setProperty("/leaveTypeDescByCode",s);t.setProperty("/leaveTypeFullDescByCode",n);t.setProperty("/dataLoaded",true);t.setProperty("/busy",false);this._refreshTableBindings()},error:e=>{console.error("Error loading leave types:",e);o.show("Error loading leave type data");t.setProperty("/dataLoaded",true);t.setProperty("/busy",false);this._refreshTableBindings()}})},_refreshTableBindings:function(){try{const e=this.byId("tblRequests");const t=e?.getBinding("items");if(t?.refresh){t.refresh(true)}}catch(e){console.warn("Could not refresh bindings:",e.message)}},formatLeaveTypeDesc:function(e){if(!e)return"";try{const t=this.getView()?.getModel("view");if(!t)return String(e);const o=t.getProperty("/dataLoaded");if(!o)return String(e);const s=t.getProperty("/leaveTypeDescByCode")||{};const n=String(e).trim().toUpperCase();return s[n]||e}catch(t){console.error("Error in formatLeaveTypeDesc:",t);return String(e)}},formatLeaveTypeFullDesc:function(e){if(!e)return"";try{const t=this.getView()?.getModel("view");if(!t)return String(e);const o=t.getProperty("/dataLoaded");if(!o)return String(e);const s=t.getProperty("/leaveTypeFullDescByCode")||{};const n=String(e).trim().toUpperCase();return s[n]||e}catch(t){console.error("Error in formatLeaveTypeFullDesc:",t);return String(e)}},formatDateRange:function(e,t){if(!e&&!t)return"";try{const o=n.getDateInstance({style:"medium"});const s=e?o.format(new Date(e)):"";const r=t?o.format(new Date(t)):"";return s&&r?`${s} ‚Üí ${r}`:s||r}catch(o){console.error("Error in formatDateRange:",o);return`${e||""} ‚Üí ${t||""}`}},formatDateTime:function(e){if(!e)return"";try{const t=n.getDateTimeInstance({style:"medium"});return t.format(new Date(e))}catch(t){console.error("Error in formatDateTime:",t);return e}},formatStatusState:function(e){switch((e||"").toLowerCase()){case"pending":return"Warning";case"approved":return"Success";case"rejected":return"Error";case"cancelled":return"None";default:return"None"}},onUpdateFinished:function(e){const t=this.byId("tblRequests");const o=t?.getBinding("items");let s=e.getParameter("total");if((s===undefined||s===null)&&o?.getLength){s=o.getLength()}const n=this.getView().getModel("view");n.setProperty("/counts/leaveRequests",s?`(${s})`:"");this.byId("msEmpty")?.setVisible(!s||s===0);this._updateKPIs()},_updateKPIs:function(){const e=this.byId("tblRequests");const t=e?.getItems()||[];const o=this.getView().getModel("view");let s=0;let n=0;let r=0;const i=new Date;i.setHours(0,0,0,0);t.forEach(e=>{const t=e.getBindingContext();const o=t?.getObject();if(!o)return;const a=(o.status||"").toLowerCase();if(a==="pending"){s++}else if(a==="approved"&&o.approvedAt){const e=new Date(o.approvedAt);e.setHours(0,0,0,0);if(e.getTime()===i.getTime()){n++}}else if(a==="rejected"&&o.approvedAt){const e=new Date(o.approvedAt);e.setHours(0,0,0,0);if(e.getTime()===i.getTime()){r++}}});o.setProperty("/kpi/pending",s);o.setProperty("/kpi/approvedToday",n);o.setProperty("/kpi/rejectedToday",r)},onSelectionChange:function(){const e=this.byId("tblRequests");const t=(e?.getSelectedItems()?.length||0)>0;this.byId("btnApproveSel")?.setEnabled(t);this.byId("btnRejectSel")?.setEnabled(t)},onRowPress:function(e){const t=e.getSource().getBindingContext();const o=this.byId("popDetails");if(o&&t){o.setBindingContext(t);o.openBy(e.getSource())}},onStatusChange:function(){this._applyFilters()},onDateRangeChange:function(){this._applyFilters()},onLiveSearch:function(){this._applyFilters()},onSearch:function(){const e=(this.byId("reqSearch")?.getValue()||"").trim();const t=/^[A-Za-z]{2,}\d{2,}$|^\d{3,}$/.test(e);if(t){this.loadRequestsForEmployee(e)}else if(!e){this.loadRequestsForEmployee("")}else{this._applyFilters()}},onClearFilters:function(){this.byId("selStatus")?.setSelectedKey("All");const e=this.byId("drSubmitted");if(e){e.setDateValue(null);e.setSecondDateValue(null)}this.byId("reqSearch")?.setValue("");this.loadRequestsForEmployee("");this._applyFilters()},onRefresh:function(){const e=this.byId("tblRequests");const t=e?.getBinding("items");const s=this.getView().getModel("view");const n=!!s.getProperty("/useActionFeed");if(n){const e=s.getProperty("/lastActionEmployeeID");if(e){this.loadRequestsForEmployee(e);return}}if(t?.refresh){t.refresh()}o.show("Data refreshed")},_applyFilters:function(){const e=this.byId("tblRequests")?.getBinding("items");if(!e)return;const t=this.getView().getModel("view");const o=!!t.getProperty("/useActionFeed");const s=[];const n=this.byId("selStatus")?.getSelectedKey();if(n&&n!=="All"){s.push(new r("status",i.EQ,n))}const a=this.byId("drSubmitted");if(a?.getDateValue()&&a?.getSecondDateValue()){const e=a.getDateValue();const t=a.getSecondDateValue();s.push(new r({filters:[new r("submittedAt",i.GE,e),new r("submittedAt",i.LE,t)],and:true}))}const c=this.byId("reqSearch")?.getValue();if(c&&c.trim()){if(o){s.push(new r({filters:[new r("empname",i.Contains,c),new r("leaveType",i.Contains,c),new r("reason",i.Contains,c)],and:false}))}else{s.push(new r({filters:[new r("empname",i.Contains,c),new r("employee_employeeId",i.Contains,c),new r("leaveType_code",i.Contains,c),new r("reason",i.Contains,c)],and:false}))}}e.filter(s)},_bindTableToAction:function(e){const o=this.byId("tblRequests");if(!o)return;const s=new t({requests:e||[]});this.getView().setModel(s,"action");const n=o.getBindingInfo("items");const r=n?.template?.clone();o.unbindItems();o.bindItems({path:"action>/requests",template:r});const i=this.getView().getModel("view");i.setProperty("/useActionFeed",true);this._applyFilters()},_bindTableToOData:function(){const e=this.byId("tblRequests");if(!e)return;const t=e.getBindingInfo("items");const o=t?.template?.clone();e.unbindItems();e.bindItems({path:"/LeaveRequests",template:o,parameters:{$count:true}});const s=this.getView().getModel("view");s.setProperty("/useActionFeed",false)},loadRequestsForEmployee:function(e){const t=this.getView().getModel();const n=this.getView().getModel("view");if(!e){this._bindTableToOData();n.setProperty("/lastActionEmployeeID","");this._refreshTableBindings();return}if(!t?.callFunction){s.error("OData action call not available on model.");return}sap.ui.core.BusyIndicator.show(0);t.callFunction("/leaveRequests",{method:"POST",urlParameters:{employeeID:e},success:t=>{sap.ui.core.BusyIndicator.hide();const s=t||{};const r=s.requests||[];const i=Number(s.count||r.length||0);this._bindTableToAction(r);n.setProperty("/lastActionEmployeeID",e);o.show(`Loaded ${i} request(s) for employee ${e}`)},error:e=>{sap.ui.core.BusyIndicator.hide();console.error("leaveRequests action failed:",e);let t="Failed to load employee requests.";try{const o=JSON.parse(e.responseText);t=o?.error?.message||t}catch(e){}s.error(t)}})},onApproveOne:function(e){const t=e.getSource().getBindingContext();const o=t?.getObject();if(!o)return;const n=o.empname||o.employee_employeeId||"Unknown";s.confirm(`Approve leave request for ${n}?`,{onClose:e=>{if(e===s.Action.OK){this._approveRequest(o.ID||o.id)}}})},onRejectOne:function(e){const t=e.getSource().getBindingContext();const o=t?.getObject();if(!o)return;this._openRejectDialog(o)},onApproveFromPopover:function(){const e=this.byId("popDetails");const t=e?.getBindingContext();const o=t?.getObject();if(!o)return;const n=o.empname||o.employee_employeeId||"Unknown";s.confirm(`Approve leave request for ${n}?`,{onClose:t=>{if(t===s.Action.OK){this._approveRequest(o.ID||o.id);e.close()}}})},onRejectFromPopover:function(){const e=this.byId("popDetails");const t=e?.getBindingContext();const o=t?.getObject();if(!o)return;e.close();this._openRejectDialog(o)},onApproveSelected:function(){const e=this.byId("tblRequests");const t=e?.getSelectedItems()||[];if(t.length===0){o.show("Please select at least one request");return}const n=t.map(e=>{const t=e.getBindingContext();const o=t.getObject();return{id:o.ID||o.id}});s.confirm(`Approve ${n.length} leave request(s)?`,{onClose:e=>{if(e===s.Action.OK){this._approveMultipleRequests(n)}}})},onRejectSelected:function(){const e=this.byId("tblRequests");const t=e?.getSelectedItems()||[];if(t.length===0){o.show("Please select at least one request");return}const s=t.map(e=>{const t=e.getBindingContext();const o=t.getObject();const s=o.ID||o.id;const n=o.empname||o.employee_employeeId||"Unknown";const r=o.leaveType||this.formatLeaveTypeFullDesc(o.leaveType_code);return{id:s,empname:n,leaveType:r}});this._openBulkRejectDialog(s)},_openRejectDialog:function(e){const t=this.getView().getModel("view");const o=e.empname||e.employee_employeeId||"Unknown";const s=e.leaveType||this.formatLeaveTypeFullDesc(e.leaveType_code);t.setProperty("/rejectData/employeeName",o);t.setProperty("/rejectData/leaveType",s);t.setProperty("/rejectData/comments","");t.setProperty("/rejectData/commentLength",0);t.setProperty("/rejectData/requestId",e.ID||e.id);t.setProperty("/rejectData/isBulk",false);this.byId("rejectCommentDialog")?.open()},_openBulkRejectDialog:function(e){const t=this.getView().getModel("view");t.setProperty("/rejectData/employeeName",`${e.length} employees`);t.setProperty("/rejectData/leaveType","Multiple requests");t.setProperty("/rejectData/comments","");t.setProperty("/rejectData/commentLength",0);t.setProperty("/rejectData/bulkRequests",e);t.setProperty("/rejectData/isBulk",true);this.byId("rejectCommentDialog")?.open()},onCommentChange:function(e){const t=e.getParameter("value")||"";this.getView().getModel("view").setProperty("/rejectData/commentLength",t.length)},onConfirmReject:function(){const e=this.getView().getModel("view");const t=e.getProperty("/rejectData");if(!t.comments||!t.comments.trim()){o.show("Please enter rejection comments");return}if(t.isBulk){this._rejectMultipleRequests(t.bulkRequests,t.comments)}else{this._rejectRequest(t.requestId,t.comments)}this.byId("rejectCommentDialog")?.close()},onCancelReject:function(){this.byId("rejectCommentDialog")?.close()},_approveRequest:function(e){const t=this.getView().getModel();const n="MANAGER001";const r={requestId:e,approverId:n,comments:""};if(t?.callFunction){sap.ui.core.BusyIndicator.show(0);t.callFunction("/approveLeaveRequest",{method:"POST",urlParameters:r,success:()=>{sap.ui.core.BusyIndicator.hide();o.show("Leave request approved successfully");this.onRefresh()},error:e=>{sap.ui.core.BusyIndicator.hide();console.error("Approve error:",e);let t="Failed to approve leave request.";try{const o=JSON.parse(e.responseText);t=o?.error?.message||t}catch(e){}s.error(t)}})}else{s.information("OData action call not available")}},_rejectRequest:function(e,t){const n=this.getView().getModel();const r="MANAGER001";const i={requestId:e,approverId:r,comments:t};if(n?.callFunction){sap.ui.core.BusyIndicator.show(0);n.callFunction("/rejectLeaveRequest",{method:"POST",urlParameters:i,success:()=>{sap.ui.core.BusyIndicator.hide();o.show("Leave request rejected successfully");this.onRefresh()},error:e=>{sap.ui.core.BusyIndicator.hide();console.error("Reject error:",e);let t="Failed to reject leave request.";try{const o=JSON.parse(e.responseText);t=o?.error?.message||t}catch(e){}s.error(t)}})}else{s.information("OData action call not available")}},_approveMultipleRequests:function(e){const t=this.getView().getModel();const n="MANAGER001";let r=0;let i=0;sap.ui.core.BusyIndicator.show(0);const a=c=>{if(c>=e.length){sap.ui.core.BusyIndicator.hide();if(i===0){o.show(`Successfully approved ${r} request(s)`)}else{s.warning(`Approved ${r} request(s).\n${i} request(s) failed.`)}this.onRefresh();return}const l=e[c];const u={requestId:l.id,approverId:n,comments:""};if(t?.callFunction){t.callFunction("/approveLeaveRequest",{method:"POST",urlParameters:u,success:()=>{r++;a(c+1)},error:e=>{i++;console.error(`Failed to approve request ${l.id}:`,e);a(c+1)}})}else{sap.ui.core.BusyIndicator.hide();s.information("OData action call not available")}};a(0)},_rejectMultipleRequests:function(e,t){const n=this.getView().getModel();const r="MANAGER001";let i=0;let a=0;sap.ui.core.BusyIndicator.show(0);const c=l=>{if(l>=e.length){sap.ui.core.BusyIndicator.hide();if(a===0){o.show(`Successfully rejected ${i} request(s)`)}else{s.warning(`Rejected ${i} request(s).\n${a} request(s) failed.`)}this.onRefresh();return}const u=e[l];const d={requestId:u.id,approverId:r,comments:t};if(n?.callFunction){n.callFunction("/rejectLeaveRequest",{method:"POST",urlParameters:d,success:()=>{i++;c(l+1)},error:e=>{a++;console.error(`Failed to reject request ${u.id}:`,e);c(l+1)}})}else{sap.ui.core.BusyIndicator.hide();s.information("OData action call not available")}};c(0)},onLogout:function(){s.confirm("Are you sure you want to logout?",{actions:[s.Action.OK,s.Action.CANCEL],emphasizedAction:s.Action.OK,onClose:e=>{if(e!==s.Action.OK)return;try{sessionStorage.clear()}catch(e){console.error("Error clearing session storage:",e)}try{localStorage.clear()}catch(e){console.error("Error clearing local storage:",e)}if(sap.ushell?.Container){window.location.hash="#Shell-home";return}const t=this.getOwnerComponent?.();const o=t?.getRouter?.();if(o?.navTo){o.navTo("Login",{},true);return}window.location.replace("/login")}})}})});
sap.ui.predefine("lmsui5/controller/Register.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/BusyIndicator"],function(e,s,t,r,o){"use strict";return e.extend("lmsui5.controller.Register",{onInit:function(){const e=new s({firstName:"",lastName:"",email:"",managerId:"",password:"",confirmPassword:""});this.getView().setModel(e,"register");const t=this.getOwnerComponent().getRouter();t.getRoute("Register").attachPatternMatched(this._onRegisterRouteMatched,this);this.getView().addEventDelegate({onAfterRendering:this._setupEnterKeyNavigation.bind(this)})},_setupEnterKeyNavigation:function(){const e=this;const s=["firstName","lastName","email","managerId","pass","confirmPassword"];s.forEach(e=>{const s=this.byId(e);if(s&&s._enterDelegate){s.removeEventDelegate(s._enterDelegate,s);s._enterDelegate=null}});const t=this.byId("Register");if(t&&t._enterDelegate){t.removeEventDelegate(t._enterDelegate,t);t._enterDelegate=null}s.forEach((t,r)=>{const o=this.byId(t);if(o){const t={onsapenter:function(){if(r<s.length-1){const t=e.byId(s[r+1]);t&&t.focus&&t.focus()}else{const s=e.byId("Register");s&&s.focus&&s.focus()}}};o.addEventDelegate(t,o);o._enterDelegate=t}});if(t){const e={onsapenter:()=>this.onRegister()};t.addEventDelegate(e,t);t._enterDelegate=e}},_onRegisterRouteMatched:function(){const e=this.getView().getModel("register");if(e){e.setData({firstName:"",lastName:"",email:"",managerId:"",password:"",confirmPassword:""})}const s=this.byId("registerMsg");s&&s.setVisible(false);const t=this.byId("firstName");t&&t.focus&&t.focus()},onBackToLogin:function(){this.getOwnerComponent().getRouter().navTo("Login")},onRegister:async function(){const e=this.getView().getModel("register");const s=e.getData();const t=this.byId("registerMsg");const a=this.byId("Register");if(!s.firstName?.trim()){this._showError(t,"Please enter first name");return}if(!s.lastName?.trim()){this._showError(t,"Please enter last name");return}if(!s.email?.trim()){this._showError(t,"Please enter email");return}const i=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!i.test(s.email)){this._showError(t,"Please enter a valid email address");return}if(!s.password?.trim()){this._showError(t,"Please enter password");return}if(s.password.length<6){this._showError(t,"Password must be at least 6 characters");return}if(s.password!==s.confirmPassword){this._showError(t,"Passwords do not match");return}if(a){a.setEnabled(false)}o.show(0);try{console.log("üì§ Submitting registration request...");console.log("üìã Registration data:",{firstName:s.firstName.trim(),lastName:s.lastName.trim(),email:s.email.trim(),managerId:s.managerId?.trim()||"",password:"***"});const a={firstName:s.firstName.trim(),lastName:s.lastName.trim(),email:s.email.trim(),password:s.password};if(s.managerId?.trim()){a.managerId=s.managerId.trim()}console.log("üìù Request body:",JSON.stringify(a,null,2));const i=await fetch("/odata/v4/my-services/register",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)});console.log("üì• Response status:",i.status);console.log("üì• Response headers:",i.headers);let n=null;const l=i.headers.get("content-type");try{if(l&&l.includes("application/json")){n=await i.json()}else{const e=await i.text();console.log("üì• Response text:",e);n={success:false,message:e}}}catch(e){console.error("‚ùå Error parsing response:",e);n={success:false,message:"Invalid response from server"}}console.log("üì• Parsed response:",JSON.stringify(n,null,2));if(!i.ok){const e=n?.message||n?.error?.message||"Registration failed";console.error("‚ùå Server error:",e);throw new Error(e)}if(n&&!n.success){throw new Error(n.message||"Registration failed")}console.log("‚úÖ Registration successful:",n);r.show(n?.message||"Registration successful! Redirecting to login...");e.setData({firstName:"",lastName:"",email:"",managerId:"",password:"",confirmPassword:""});if(t){t.setVisible(false)}setTimeout(()=>{o.hide();this.getOwnerComponent().getRouter().navTo("Login")},1500)}catch(e){console.error("‚ùå Registration error:",e);this._showError(t,e.message||"Registration failed. Please try again.");o.hide()}finally{if(a){a.setEnabled(true)}o.hide()}},_showError:function(e,s){if(e){e.setText(s);e.setVisible(true)}else{t.error(s)}}})});
sap.ui.predefine("lmsui5/controller/View1.controller", ["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/m/MessageToast"],function(e,t,s){"use strict";return e.extend("lmsui5.controller.View1",{onRegister:function(){this.getOwnerComponent().getRouter().navTo("Register")},onInit:function(){const e=this.byId("username");const t=this.byId("password");if(e){e.addEventDelegate({onsapenter:function(){t&&t.focus()}})}if(t){t.addEventDelegate({onsapenter:function(){this.onLogin()}.bind(this)})}const s=this.getOwnerComponent().getRouter();s.getRoute("Login").attachPatternMatched(this._onLoginRouteMatched,this);this.getView().addEventDelegate({onBeforeShow:function(){this._resetLoginForm()}.bind(this)})},_resetLoginForm:function(){const e=this.byId("username");const t=this.byId("password");const s=this.byId("msg");if(e)e.setValue("");if(t)t.setValue("");if(s)s.setVisible(false)},_onLoginRouteMatched:function(){this._resetLoginForm();const e=this.getOwnerComponent().getModel("auth");if(e){e.setProperty("/isAuthenticated",false);e.setProperty("/error","");e.setProperty("/user",{})}},onLogin:async function(){const e=(this.byId("username").getValue()||"").trim();const t=(this.byId("password").getValue()||"").trim();if(!e||!t){this._showError("Please enter email and password.");return}const o=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!o.test(e)){this._showError("Please enter a valid email address.");return}const n=this.byId("msg");if(n)n.setVisible(false);try{const o=await fetch("/odata/v4/my-services/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!o.ok){const e=o.clone();let t="Invalid credentials";try{const e=await o.json();t=e?.error?.message||e?.message||t}catch(s){try{t=await e.text()||t}catch(e){}}throw new Error(t)}const n=await o.json();const r=n?.employee;const i=this.getOwnerComponent().getRouter();const a=this.getOwnerComponent().getModel("auth");if(a){a.setData({user:n,isAuthenticated:true,error:""})}try{localStorage.setItem("login_email",e)}catch(e){}if(!r){s.show("Invalid user");return}s.show(`Welcome, ${r?.firstName||r?.email}`);const c=(r?.email||"").toLowerCase()==="admin@gmail.com";const l=(n?.role||n?.employee?.role||"").toLowerCase();const g=l==="manager";if(c||g){i.navTo("Manager")}else{const e=r?.email;if(e){i.navTo("Employee",{username:e})}else{i.navTo("Employee")}}}catch(e){this._showError(e.message||"Login failed")}},_showError:function(e){const s=this.getOwnerComponent().getModel("auth");if(s){s.setProperty("/error",e);s.setProperty("/isAuthenticated",false)}const o=this.byId("msg");if(o){o.setText(e);o.setType("Error");o.setShowIcon(true);o.setVisible(true)}t.error(e)},onAfterRendering:function(){try{const e=localStorage.getItem("login_email");if(e)this.byId("username").setValue(e)}catch(e){}},onOpenRegister:function(){this.getOwnerComponent().getRouter().navTo("Register")},onCancelRegister:function(){const e=this.byId("registerDialog");e&&e.close()},onSubmitRegister:async function(){const e=this.getOwnerComponent().getModel("auth");const o=e.getProperty("/register")||{};const{firstName:n,lastName:r,email:i,password:a,confirm:c}=o;if(!n||!r||!i||!a||!c){t.warning("Please fill in all required fields.");return}if(a!==c){t.error("Passwords do not match.");return}const l=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!l.test(i)){t.error("Please enter a valid email address.");return}try{s.show("Registration successful! Please log in.");this.onCancelRegister()}catch(e){console.error("Registration error:",e);t.error(e.message||"Failed to register.")}}})});
sap.ui.predefine("lmsui5/model/models", ["sap/ui/model/json/JSONModel","sap/ui/Device"],function(e,n){"use strict";return{createDeviceModel:function(){var i=new e(n);i.setDefaultBindingMode("OneWay");return i}}});
sap.ui.require.preload({
	"lmsui5/i18n/i18n.properties":'# This is the resource bundle for lmsui5\n\n#Texts for manifest.json\n\n#XTIT: Application name\nappTitle=App Title\n\n#YDES: Application description\nappDescription=An SAP Fiori application.\n#XTIT: Main view title\ntitle=App Title',
	"lmsui5/manifest.json":'{"_version":"1.76.0","sap.app":{"id":"lmsui5","type":"application","i18n":{"bundleUrl":"i18n/i18n.properties","supportedLocales":[""]},"applicationVersion":{"version":"0.0.1"},"title":"{{appTitle}}","description":"{{appDescription}}","resources":"resources.json","sourceTemplate":{"id":"@sap/generator-fiori:basic","version":"1.20.0","toolsId":"4ff312fc-432e-4416-887d-b7ebf9ec7882"},"dataSources":{"mainService":{"uri":"/odata/v4/my-services/","type":"OData","settings":{"annotations":[],"odataVersion":"4.0"}}}},"sap.ui":{"technology":"UI5","icons":{"icon":"","favIcon":"","phone":"","phone@2":"","tablet":"","tablet@2":""},"deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"flexEnabled":false,"dependencies":{"minUI5Version":"1.143.2","libs":{"sap.m":{},"sap.ui.core":{},"sap.ui.layout":{},"sap.ui.unified":{}}},"contentDensities":{"compact":true,"cozy":true},"models":{"i18n":{"type":"sap.ui.model.resource.ResourceModel","settings":{"bundleName":"lmsui5.i18n.i18n","supportedLocales":[""]}},"":{"type":"sap.ui.model.odata.v4.ODataModel","dataSource":"mainService","preload":true,"settings":{"synchronizationMode":"None","operationMode":"Server","autoExpandSelect":true,"earlyRequests":true}},"user":{"type":"sap.ui.model.json.JSONModel","settings":{}},"auth":{"type":"sap.ui.model.json.JSONModel","settings":{"isAuthenticated":false,"user":{},"error":""}}},"resources":{"css":[{"uri":"css/style.css"}]},"routing":{"config":{"routerClass":"sap.m.routing.Router","controlAggregation":"pages","controlId":"app","transition":"slide","type":"View","viewType":"XML","path":"lmsui5.view","async":true,"viewPath":"lmsui5.view"},"routes":[{"name":"Login","pattern":"","target":["Login"]},{"name":"Employee","pattern":"employee/{username}","target":["Employee"]},{"name":"Manager","pattern":"manager","target":["Manager"]},{"name":"Register","pattern":"register","target":["Register"]}],"targets":{"Login":{"id":"Login","name":"View1","viewLevel":1},"Employee":{"id":"Employee","name":"Employee","viewLevel":2},"Manager":{"id":"Manager","name":"Manager","viewLevel":2},"Register":{"id":"Register","name":"Register","viewLevel":1}}},"rootView":{"viewName":"lmsui5.view.App","type":"XML","id":"App","async":true},"flexBundle":false}}',
	"lmsui5/view/App.view.xml":'<mvc:View controllerName="lmsui5.controller.App"\n    displayBlock="true"\n    xmlns:mvc="sap.ui.core.mvc"\n    xmlns="sap.m"><App id="app"></App></mvc:View>',
	"lmsui5/view/ApplyLeave.fragment.xml":'\n<core:FragmentDefinition\n  xmlns="sap.m"\n  xmlns:mvc="sap.ui.core.mvc"\n  xmlns:core="sap.ui.core"\n  xmlns:unified="sap.ui.unified"\n  ><Dialog\n    id="applyLeaveDialog"\n    \n    title="Apply for Leave"\n    class="sapUiContentPadding"\n    type="Message"><content><VBox width="100%" renderType="Bare" class="sapUiSmallMarginTop"><Label text="Leave Type" labelFor="leaveTypeSelect"/><Select\n          id="leaveTypeSelect"\n          width="100%"\n          required="true"\n          selectedKey="{applyLeave>/selectedLeaveType}"\n          items="{\n            path: \'applyLeave>/leaveTypes\'\n          }"><core:Item key="{applyLeave>code}" text="{applyLeave>description}"/></Select><Label text="Select Dates" class="sapUiSmallMarginTop"/><unified:Calendar\n          id="leaveCalendar"\n          minDate="{applyLeave>/minDate}"\n          maxDate="{applyLeave>/maxDate}"\n          singleSelection="false"\n          months="1"\n          intervalSelection="false"\n          select=".onCalendarSelect"></unified:Calendar><ObjectStatus\n          class="sapUiSmallMarginTop"\n          text="{= ${applyLeave>/selectedDates}.length ? \'Selected Days: \' + ${applyLeave>/selectedDates}.length : \'No dates selected\' }"\n          state="Information"/><Label text="Reason (optional)" class="sapUiSmallMarginTop"/><TextArea\n          id="reasonInput"\n          rows="4"\n          width="100%"\n          placeholder="Add any note for approver"\n          value="{applyLeave>/reason}"/></VBox></content><beginButton><Button text="Submit" type="Emphasized" press=".onSubmitLeave"/></beginButton><endButton><Button text="Cancel" press=".onCancelApplyLeave"/></endButton></Dialog></core:FragmentDefinition>\n',
	"lmsui5/view/Employee.view.xml":'<mvc:View\n  controllerName="lmsui5.controller.Employee"\n  xmlns:mvc="sap.ui.core.mvc"\n  xmlns="sap.m"><Page id="employeePage" title="My Leave Balances"><headerContent><ObjectStatus text="{user>/role}" state="Information"/></headerContent><content><VBox class="sapUiMediumMargin"><HBox width="100%" justifyContent="SpaceBetween" alignItems="Center"><Title text="Welcome, {user>/fullName}" level="H2"/><HBox width="100%" justifyContent="End" alignItems="Center"><Button\n              text="Logout"\n              icon="sap-icon://log"\n              press=".onLogout"\n              class="lightRedButton"/></HBox></HBox><HBox justifyContent="End" width="100%" class="sapUiTinyMarginTop"><Button\n            id="btnApplyLeave"\n            text="Apply Leave"\n            type="Emphasized"\n            icon="sap-icon://add-employee"\n            press=".onOpenApplyLeave"/></HBox><Toolbar class="sapUiMediumMarginTop"><SearchField id="sf" placeholder="Search by leave type code or description"\n                       width="20rem" search=".onSearch" liveChange=".onLiveChange"/><ToolbarSpacer/><Button text="Clear" press=".onClear" icon="sap-icon://reset"/><Button text="Refresh" press=".onRefresh" icon="sap-icon://refresh" type="Emphasized"/></Toolbar><Table\n          id="leaveBalancesTable"\n          inset="false"\n          items="{user>/leaveBalances}"\n          class="sapUiMediumMarginTop"><headerToolbar><Toolbar><Title text="Leave Summary"/><ToolbarSpacer/><Text text="(Employee ID: {user>/employeeId})"/></Toolbar></headerToolbar><columns><Column width="15rem"><Text text="Leave Type"/></Column><Column width="12rem" hAlign="End"><Text text="Accrued Days"/></Column><Column width="12rem" hAlign="End"><Text text="Used Days"/></Column><Column width="12rem" hAlign="End"><Text text="Balance"/></Column></columns><items><ColumnListItem><cells><Text text="{user>leaveTypeCode}"/><Text text="{user>accruedDays}"/><Text text="{user>usedDays}"/><ObjectStatus\n                  text="{user>balance}"\n                  state="{ path: \'user>balance\', formatter: \'.formatBalanceState\' }"/></cells></ColumnListItem></items></Table><Table\n          id="myRequestsTable"\n          inset="false"\n          items="{leaveRequests>/requests}"\n          class="sapUiMediumMarginTop"><headerToolbar><Toolbar><Title text="My Leave Requests"/><ToolbarSpacer/><ObjectStatus text="{leaveRequests>/counts/pending}" title="Pending" state="Warning" class="sapUiSmallMarginEnd"/><ObjectStatus text="{leaveRequests>/counts/approved}" title="Approved" state="Success" class="sapUiSmallMarginEnd"/><ObjectStatus text="{leaveRequests>/counts/rejected}" title="Rejected" state="Error"/></Toolbar></headerToolbar><columns><Column width="12rem"><Text text="Leave Type"/></Column><Column width="16rem"><Text text="Period"/></Column><Column width="8rem" hAlign="End"><Text text="Days"/></Column><Column width="18rem"><Text text="Reason"/></Column><Column width="12rem"><Text text="Status"/></Column><Column width="8rem" hAlign="End"><Text text="Actions"/></Column></columns><items><ColumnListItem type="Active" press=".onViewRequestDetails"><cells><Text text="{leaveRequests>leaveType}"/><Text text="{\n                  parts: [{path:\'leaveRequests>startDate\'},{path:\'leaveRequests>endDate\'}],\n                  formatter: \'.formatDateRange\'\n                }"/><Text text="{leaveRequests>daysRequested}"/><Text text="{leaveRequests>reason}" wrapping="true" maxLines="2"/><ObjectStatus\n                  text="{leaveRequests>status}"\n                  state="{ path: \'leaveRequests>status\', formatter: \'.formatStatusState\' }"/><HBox justifyContent="End"><Button\n                    text="View"\n                    type="Transparent"\n                    icon="sap-icon://detail-view"\n                    press=".onOpenManagerMessage"\n                    tooltip="View manager message"/></HBox></cells></ColumnListItem></items></Table><Table\n          id="balancesTable"\n          inset="false"\n          growing="true"\n          growingScrollToLoad="true"\n          items="{\n            path: \'/LeaveBalance\',\n            model: \'\',\n            parameters: {\n              $count: true,\n              $expand: \'leaveType\'\n            }\n          }"\n          class="sapUiMediumMarginTop"><items><ColumnListItem><cells><ObjectIdentifier title="{leaveType/code}" text="{leaveType/description}"/><ObjectStatus\n                  text="{= ${leaveType/isPaid} ? \'Paid\' : \'Unpaid\' }"\n                  state="{= ${leaveType/isPaid} ? \'Success\' : \'None\' }"/><Text text="{leaveType/maxDays}"/><Text text="{path: \'accruedDays\', type: \'sap.ui.model.type.Float\'}"/><Text text="{path: \'usedDays\', type: \'sap.ui.model.type.Float\'}"/><ObjectStatus\n                  text="{balance}"\n                  state="{ path: \'balance\', formatter: \'.formatBalanceState\' }"/></cells></ColumnListItem></items></Table></VBox></content></Page></mvc:View>',
	"lmsui5/view/Manager.view.xml":'<mvc:View\n  controllerName="lmsui5.controller.Manager"\n  xmlns:mvc="sap.ui.core.mvc"\n  xmlns="sap.m"\n  xmlns:core="sap.ui.core"><Page id="managerPage" title="Leave Approvals"><headerContent><ObjectStatus text="{= \'Role: \' + (${user>/role} || \'Manager\')}" state="Information"/></headerContent><content><VBox class="sapUiMediumMargin"><HBox width="100%" justifyContent="SpaceBetween" alignItems="Center"><Title text="Manager Dashboard" level="H2"/><HBox width="100%" justifyContent="End" alignItems="Center"><Button text="Logout" icon="sap-icon://log" press=".onLogout" class="lightRedButton"/></HBox></HBox><HBox width="100%" class="sapUiSmallMarginTop" wrap="Wrap" renderType="Bare"><ObjectStatus id="kpiPending"  title="Pending"         text="{view>/kpi/pending}"       state="Warning" class="sapUitinyMarginEnd"/><ObjectStatus id="kpiApproved" title="Approved Today"  text="{view>/kpi/approvedToday}" state="Success" class="sapUitinyMarginEnd"/><ObjectStatus id="kpiRejected" title="Rejected Today"  text="{view>/kpi/rejectedToday}" state="Error"/></HBox><Toolbar class="sapUiMediumMarginTop"><Select id="selStatus" width="10rem" change=".onStatusChange"><items><core:Item key="Pending"  text="Pending"/><core:Item key="Approved" text="Approved"/><core:Item key="Rejected" text="Rejected"/><core:Item key="Cancelled" text="Cancelled"/><core:Item key="All"      text="All"/></items></Select><SearchField id="reqSearch"\n                       placeholder="Employee, Leavetype, or Reason"\n                       width="22rem"\n                       liveChange=".onLiveSearch"\n                       search=".onSearch"\n                       class="sapUiTinyMarginBegin"/><ToolbarSpacer/><Button text="Clear"   icon="sap-icon://reset"   press=".onClearFilters"/><Button text="Refresh" icon="sap-icon://refresh" type="Emphasized" press=".onRefresh"/></Toolbar><Toolbar><Title text="Requests from Your Team"/><ToolbarSpacer/><Button id="btnApproveSel" text="Approve Selected" type="Accept" icon="sap-icon://accept" enabled="false" press=".onApproveSelected"/><Button id="btnRejectSel"  text="Reject Selected"  type="Reject" icon="sap-icon://decline" enabled="false" press=".onRejectSelected" class="sapUiTinyMarginBegin"/></Toolbar><Table id="tblRequests"\n               mode="MultiSelect"\n               growing="true"\n               growingScrollToLoad="true"\n               items="{\n                 path: \'/LeaveRequests\',\n                 parameters: { $count: true },\n                 templateShareable: false\n               }"\n               updateFinished=".onUpdateFinished"\n               selectionChange=".onSelectionChange"\n               class="sapUiMediumMarginTop"><headerToolbar><Toolbar><Title text="Leave Requests"/><ToolbarSpacer/><Text id="txtCount" text="{view>/counts/leaveRequests}"/></Toolbar></headerToolbar><columns><Column width="18rem"><Text text="Employee Name"/></Column><Column width="12rem"><Text text="Leave Type"/></Column><Column width="16rem"><Text text="Period"/></Column><Column width="8rem"  hAlign="End"><Text text="Days"/></Column><Column width="18rem"><Text text="Reason"/></Column><Column width="5rem"><Text text="Status"/></Column><Column width="16rem" hAlign="End"><Text text="Actions"/></Column></columns><items><ColumnListItem type="Active" press=".onRowPress"><cells><Text text="{empname}"/><Text text="{ path: \'leaveType_code\', formatter: \'.formatLeaveTypeDesc\' }"/><Text text="{ parts: [{path:\'startDate\'},{path:\'endDate\'}], formatter: \'.formatDateRange\' }"/><Text text="{daysRequested}"/><Text text="{reason}" wrapping="true" maxLines="2"/><ObjectStatus text="{status}" state="{ path: \'status\', formatter: \'.formatStatusState\' }"/><HBox justifyContent="End" width="100%"><Button text="Approve" type="Accept" icon="sap-icon://accept"\n                          press=".onApproveOne"\n                          visible="{= ${status} === \'Pending\' }"/><Button text="Reject" type="Reject" icon="sap-icon://decline"\n                          press=".onRejectOne"\n                          class="sapUiTinyMarginBegin"\n                          visible="{= ${status} === \'Pending\' }"/></HBox></cells></ColumnListItem></items></Table><MessageStrip id="msEmpty"\n          text="No matching requests. Adjust filters or refresh."\n          type="Information"\n          showIcon="true"\n          visible="false"\n          class="sapUiSmallMarginTop"/><ResponsivePopover id="popDetails" placement="Auto" title="Leave Request Details"><VBox class="sapUiSmallMargin" width="400px"><ObjectAttribute title="Employee Name" text="{empname}"/><ObjectAttribute title="Leave Type"\n              text="{ path: \'leaveType_code\', formatter: \'.formatLeaveTypeFullDesc\' }"/><ObjectAttribute title="Period"\n              text="{ parts: [{path:\'startDate\'},{path:\'endDate\'}], formatter: \'.formatDateRange\' }"/><ObjectAttribute title="Days"\n              text="{daysRequested}"/><ObjectAttribute title="Submitted"\n              text="{ path: \'submittedAt\', formatter: \'.formatDateTime\' }"/><ObjectAttribute title="Reason"\n              text="{reason}"/><ObjectStatus title="Status" text="{status}" state="{ path: \'status\', formatter: \'.formatStatusState\' }"/><HBox class="sapUiSmallMarginTop" justifyContent="End"><Button text="Approve" type="Accept" icon="sap-icon://accept" press=".onApproveFromPopover"\n                      visible="{= ${status} === \'Pending\' }"/><Button text="Reject"  type="Reject" icon="sap-icon://decline" press=".onRejectFromPopover"\n                      class="sapUiTinyMarginBegin"\n                      visible="{= ${status} === \'Pending\' }"/></HBox></VBox></ResponsivePopover><Dialog id="rejectCommentDialog" title="Reject Leave Request" type="Message" contentHeight="auto" contentWidth="50%"><content><VBox class="sapUiSmallMargin" width="100%"><ObjectAttribute title="Employee Name" text="{view>/rejectData/employeeName}"/><ObjectAttribute title="Leave Type" text="{view>/rejectData/leaveType}" class="sapUiSmallMarginTop"/><Label text="Rejection Comments (Required)" class="sapUiSmallMarginTop sapUiMediumMarginBottom"/><TextArea id="taRejectComments"\n                        value="{ path: \'view>/rejectData/comments\', type: \'sap.ui.model.type.String\' }"\n                        change=".onCommentChange"\n                        rows="5"\n                        placeholder="Enter reason for rejection..."\n                        width="90%"\n                        class="sapUiSmallMargin"/><HBox justifyContent="End" class="sapUiSmallMarginTop"><Text text="{view>/rejectData/commentLength}/500" class="sapUiSmallMargin"/></HBox></VBox></content><beginButton><Button text="Reject" type="Reject" press=".onConfirmReject"/></beginButton><endButton><Button text="Cancel" press=".onCancelReject"/></endButton></Dialog></VBox></content></Page></mvc:View>',
	"lmsui5/view/ManagerMessageDialog.fragment.xml":'<core:FragmentDefinition\n  xmlns="sap.m"\n  xmlns:core="sap.ui.core"\n  xmlns:f="sap.ui.layout.form"><Dialog\n    type="Message"\n    contentWidth="560px"\n    stretchOnPhone="true"\n    title="Manager Message"><customHeader><Bar><contentMiddle><Title text="Manager Message"/></contentMiddle><contentRight><ObjectStatus\n            text="{leaveRequests>status}"\n            state="{ path: \'leaveRequests>status\', formatter: \'.formatStatusState\' }"\n            class="sapUiTinyMarginEnd"/></contentRight></Bar></customHeader><content><VBox class="sapUiSmallMargin" width="100%"><f:SimpleForm\n          editable="false"\n          layout="ResponsiveGridLayout"\n          labelSpanXL="3" labelSpanL="3" labelSpanM="4" labelSpanS="12"\n          adjustLabelSpan="false"\n          emptySpanXL="0" emptySpanL="0" emptySpanM="0" emptySpanS="0"\n          columnsXL="2" columnsL="2" columnsM="1" singleContainerFullSize="false"><Label text="Decision Time" visible="{= !!${leaveRequests>approvedAt} }"/><Text text="{ path: \'leaveRequests>approvedAt\', formatter: \'.formatDateTime\' }"\n                visible="{= !!${leaveRequests>approvedAt} }"/><Label text="Leave Type"/><Text text="{leaveRequests>leaveType}" /><Label text="Period"/><Text text="{\n            parts: [\n              {path:\'leaveRequests>startDate\'},\n              {path:\'leaveRequests>endDate\'}\n            ],\n            formatter: \'.formatDateRange\'\n          }"/><Label text="Days"/><Text text="{leaveRequests>daysRequested}" /></f:SimpleForm><Title text="Message" level="H5" class="sapUiSmallMarginTop"/><TextArea\n          id="mmText"\n          width="80%"\n          rows="6"\n          editable="false"\n          value="{\n            path: \'leaveRequests>managerComments\',\n            formatter: \'.__mmFallback\'\n          }"\n          placeholder="No message from manager yet."\n          liveChange=".onManagerMessageLiveChange"/></VBox></content><endButton><Button text="Close" press=".onCloseManagerMessage"/></endButton></Dialog></core:FragmentDefinition>',
	"lmsui5/view/Register.view.xml":'<mvc:View\n  controllerName="lmsui5.controller.Register"\n  xmlns:mvc="sap.ui.core.mvc"\n  xmlns="sap.m"\n  xmlns:core="sap.ui.core"><App id="app2"><Page id="registerPage" showHeader="false" backgroundDesign="Solid"><content><HBox width="100%" height="100%" class="login-wrapper"><VBox width="60%" height="100%" class="login-left-bg"></VBox><VBox width="1px" height="100%" class="login-divider"></VBox><VBox width="40%" height="100%" alignItems="Center" justifyContent="Center"><VBox class="login-card" width="70%"><Title text="Create Account" class="login-title"/><Text text="Fill in your details to register" class="login-subtitle"/><MessageStrip\n                id="registerMsg"\n                type="Error"\n                showIcon="true"\n                visible="false"\n                class="sapUiTinyMarginTop"/><Input id="firstName" placeholder="First Name"\n                     value="{register>/firstName}" valueLiveUpdate="true"\n                     class="sapUiSmallMarginTop"/><Input id="lastName" placeholder="Last Name"\n                     value="{register>/lastName}" valueLiveUpdate="true"\n                     class="sapUiTinyMarginTop"/><Input id="email" placeholder="Email Address" type="Email"\n                     value="{register>/email}" valueLiveUpdate="true"\n                     class="sapUiTinyMarginTop"/><Input id="managerId" placeholder="Manager ID"\n                     value="{register>/managerId}" valueLiveUpdate="true"\n                     class="sapUiTinyMarginTop"/><Input id="pass" placeholder="Password (min 6 characters)" type="Password"\n                     value="{register>/password}" valueLiveUpdate="true"\n                     class="sapUiTinyMarginTop"/><Input id="confirmPassword" placeholder="Confirm Password" type="Password"\n                     value="{register>/confirmPassword}" valueLiveUpdate="true"\n                     class="sapUiTinyMarginTop"/><HBox class="login-actions sapUiSmallMarginTop" justifyContent="SpaceBetween" width="100%"><Button id="btnBackToLogin" text="Back to Login" type="Transparent" press=".onBackToLogin"/><Button id="Register" text="Register" type="Emphasized" width="110px" press=".onRegister"/></HBox></VBox></VBox></HBox></content></Page></App></mvc:View>',
	"lmsui5/view/RequestDetail.fragment.xml":'<core:FragmentDefinition\n  xmlns="sap.m"\n  xmlns:core="sap.ui.core"\n  xmlns:l="sap.ui.layout"><Dialog\n    title="Leave Request Details"\n    contentWidth="500px"\n    contentHeight="auto"\n    type="Message"><content><VBox class="sapUiSmallMargin"><l:VerticalLayout class="sapUiSmallMarginBottom"><ObjectAttribute title="Leave Type" text="{leaveRequests>leaveType}"/><ObjectAttribute title="Period" \n            text="{ parts: [{path:\'leaveRequests>startDate\'},{path:\'leaveRequests>endDate\'}], formatter: \'.formatDateRange\' }"/><ObjectAttribute title="Days Requested" text="{leaveRequests>daysRequested}"/><ObjectAttribute title="Submitted" \n            text="{ path: \'leaveRequests>submittedAt\', formatter: \'.formatDateTime\' }"/></l:VerticalLayout><ObjectStatus \n          title="Status"\n          text="{leaveRequests>status}" \n          state="{ path: \'leaveRequests>status\', formatter: \'.formatStatusState\' }"\n          class="sapUiSmallMarginBottom"/><VBox class="sapUiSmallMarginBottom"><Label text="Reason" class="sapUiTinyMarginBottom"/><Text text="{leaveRequests>reason}" wrapping="true"/></VBox><VBox visible="{= ${leaveRequests>status} === \'Approved\' || ${leaveRequests>status} === \'Rejected\' }"><Label text="Manager Comments" class="sapUiTinyMarginBottom"/><MessageStrip\n            text="{leaveRequests>managerComments}"\n            type="{= ${leaveRequests>status} === \'Rejected\' ? \'Error\' : \'Success\' }"\n            showIcon="true"\n            class="sapUiSmallMarginBottom"></MessageStrip></VBox><l:VerticalLayout \n          visible="{= ${leaveRequests>status} === \'Approved\' || ${leaveRequests>status} === \'Rejected\' }"><ObjectAttribute title="Approved By" text="{leaveRequests>approvedBy}"/><ObjectAttribute title="Approved On" \n            text="{ path: \'leaveRequests>approvedAt\', formatter: \'.formatDateTime\' }"/></l:VerticalLayout></VBox></content><beginButton><Button text="Close" press=".onCloseRequestDetails"/></beginButton></Dialog></core:FragmentDefinition>',
	"lmsui5/view/View1.view.xml":'<mvc:View\n  controllerName="lmsui5.controller.View1"\n  xmlns:mvc="sap.ui.core.mvc"\n  xmlns="sap.m"\n  xmlns:core="sap.ui.core"><App id="app1"><Page id="loginPage" showHeader="false" backgroundDesign="Solid"><content><HBox width="100%" height="100%" class="login-wrapper"><VBox width="60%" height="100%" class="login-left-bg"></VBox><VBox width="40%" height="100%" alignItems="Center" justifyContent="Center"><VBox width="70%" class="login-card"><Title text="Leave Application" class="login-title"/><Text text="Sign in with your organizational account" class="login-subtitle"/><Input id="username" placeholder="someone@example.com" class="sapUiSmallMarginTop"/><Input id="password" type="Password" placeholder="Password" class="sapUiSmallMarginTop"/><HBox class="login-actions sapUiSmallMarginTop" justifyContent="SpaceBetween" width="100%"><Button id="btnRegister" text="Register" type="Transparent" press=".onOpenRegister"/><Button id="btnLogin" text="Sign in" type="Emphasized" width="100px" press=".onLogin"/></HBox><MessageStrip \n                id="msg" \n                type="Error" \n                showIcon="true" \n                visible="false"\n                class="sapUiTinyMarginTop"/></VBox></VBox></HBox></content></Page></App></mvc:View>\n'
});
//# sourceMappingURL=Component-preload.js.map
