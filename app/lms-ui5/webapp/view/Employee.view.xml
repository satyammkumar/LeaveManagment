<mvc:View
  controllerName="lmsui5.controller.Employee"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m">

  <Page id="employeePage" title="My Leave Balances">
    <headerContent>
      <ObjectStatus text="{user>/role}" state="Information"/>
    </headerContent>

    <content>
      <VBox class="sapUiMediumMargin">

        <!-- Greeting -->
 
    <HBox width="100%" justifyContent="SpaceBetween" alignItems="Center">
    <Title text="Welcome, {user>/fullName}" level="H2"/>
    <!-- <Button text="Logout" icon="sap-icon://log" press=".onLogout"/> -->
    <HBox width="100%" justifyContent="End" alignItems="Center">
            <Button 
              text="Logout" 
              icon="sap-icon://log" 
              press=".onLogout" 
              class="lightRedButton"/>
          </HBox>
  </HBox>
    <HBox justifyContent="End" width="100%" class="sapUiTinyMarginTop">
          <Button
            id="btnApplyLeave"
            text="Apply Leave"
            type="Emphasized"
            icon="sap-icon://add-employee"
            press=".onOpenApplyLeave"/>
        </HBox>



           <Toolbar class="sapUiMediumMarginTop">
          <SearchField id="sf" placeholder="Search by leave type code or description"
                       width="20rem" search=".onSearch" liveChange=".onLiveChange"/>
          <ToolbarSpacer/>
          <Button text="Clear" press=".onClear" icon="sap-icon://reset"/>
          <Button text="Refresh" press=".onRefresh" icon="sap-icon://refresh" type="Emphasized"/>
        </Toolbar>

        <!-- Leave Balance Table from Backend API -->
        <Table
          id="leaveBalancesTable"
          inset="false"
          items="{user>/leaveBalances}"
          class="sapUiMediumMarginTop">

          <headerToolbar>
          
            <Toolbar>
              <Title text="Leave Summary"/>
              <ToolbarSpacer/>
              <Text text="(Employee ID: {user>/employeeId})"/>

            </Toolbar>
          </headerToolbar>

          <columns>
            <Column width="15rem"><Text text="Leave Type"/></Column>
            <Column width="12rem" hAlign="End"><Text text="Accrued Days"/></Column>
            <Column width="12rem" hAlign="End"><Text text="Used Days"/></Column>
            <Column width="12rem" hAlign="End"><Text text="Balance"/></Column>
          </columns>

          <items>
            <ColumnListItem>
              <cells>
                <Text text="{user>leaveTypeCode}"/>
                <Text text="{user>accruedDays}"/>
                <Text text="{user>usedDays}"/>
                <ObjectStatus
                  text="{user>balance}"
                  state="{ path: 'user>balance', formatter: '.formatBalanceState' }"/>
              </cells>
            </ColumnListItem>
          </items>
        </Table>

        <!-- Actions -->
    

        <!-- Leave Balance Table from OData -->
        <Table
          id="balancesTable"
          inset="false"
          growing="true"
          growingScrollToLoad="true"
          items="{
            path: '/LeaveBalance',
            model: '',
            parameters: {
              $count: true,
              $expand: 'leaveType'
            }
          }"
          class="sapUiMediumMarginTop">


          <items>
            <ColumnListItem>
              <cells>
                <!-- Leave Type info -->
                <ObjectIdentifier title="{leaveType/code}" text="{leaveType/description}"/>

                <!-- Paid or Unpaid -->
                <ObjectStatus
                  text="{= ${leaveType/isPaid} ? 'Paid' : 'Unpaid' }"
                  state="{= ${leaveType/isPaid} ? 'Success' : 'None' }"/>

                <!-- Max Days -->
                <Text text="{leaveType/maxDays}"/>

                <!-- Accrued / Used -->
                <Text text="{path: 'accruedDays', type: 'sap.ui.model.type.Float'}"/>
                <Text text="{path: 'usedDays', type: 'sap.ui.model.type.Float'}"/>

                <!-- Balance with color -->
                <ObjectStatus
                  text="{balance}"
                  state="{ path: 'balance', formatter: '.formatBalanceState' }"/>
              </cells>
            </ColumnListItem>
          </items>
        </Table>

        
        <!-- Actions -->
        
        <!-- <HBox justifyContent="End" width="100%">
          <Button
            id="btnApplyLeave"
            text="Apply Leave"
            type="Emphasized"
            icon="sap-icon://add-employee"
            press=".onOpenApplyLeave"/>
        </HBox> -->
          <!-- <HBox width="100%" justifyContent="End" alignItems="Center">
            <Button 
              text="Logout" 
              icon="sap-icon://log" 
              press=".onLogout" 
              class="lightRedButton"/>
          </HBox> -->
 

      </VBox>
    </content>

  </Page>
</mvc:View>